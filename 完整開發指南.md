# Personal AI Gallery â€” å¾é›¶é–‹å§‹å®Œæ•´æŒ‡å—

> é©ç”¨å·¥å…·ï¼šClaude Code (å‘½ä»¤è¡Œ) + Google IDE (Firebase Studio / IDX)
> ç¶“é©—å‡è¨­ï¼šæœ‰ React/Next.js åŸºç¤

---

## ğŸš€ PHASE 0ï¼šç’°å¢ƒæº–å‚™ï¼ˆç¬¬ä¸€å¤©ï¼Œç´„ 2 å°æ™‚ï¼‰

### Step 0.1 â€” å®‰è£å¿…è¦å·¥å…·

```bash
# ç¢ºèª Node.js ç‰ˆæœ¬ï¼ˆéœ€è¦ 18.17+ï¼‰
node -v

# å¦‚æœç‰ˆæœ¬å¤ªä½ï¼Œç”¨ nvm å‡ç´š
nvm install 20
nvm use 20

# å®‰è£ Claude Codeï¼ˆå¦‚æœé‚„æ²’è£ï¼‰
npm install -g @anthropic-ai/claude-code

# ç¢ºèªå®‰è£æˆåŠŸ
claude --version
```

### Step 0.2 â€” å‰µå»º Next.js é …ç›®

```bash
# ä½¿ç”¨å®˜æ–¹è…³æ‰‹æ¶ï¼Œé¸æ“‡ App Router
npx create-next-app@latest personal-ai-gallery \
  --typescript \
  --tailwind \
  --eslint \
  --app \
  --src-dir \
  --import-alias "@/*"

cd personal-ai-gallery
```

**create-next-app å•ç­”é¸é …ï¼š**
- Would you like to use TypeScript? â†’ **Yes**
- Would you like to use ESLint? â†’ **Yes**
- Would you like to use Tailwind CSS? â†’ **Yes**
- Would you like to use `src/` directory? â†’ **Yes**
- Would you like to use App Router? â†’ **Yes**
- Would you like to customize the import alias? â†’ **Yes** (`@/*`)

### Step 0.3 â€” å®‰è£æ‰€æœ‰ä¾è³´ï¼ˆä¸€æ¬¡æ€§ï¼‰

```bash
# UI çµ„ä»¶åº« shadcn/ui åˆå§‹åŒ–
npx shadcn@latest init
# é¸æ“‡ï¼šDefault style, Zinc color, CSS variables: Yes

# å®‰è£å¸¸ç”¨ shadcn çµ„ä»¶
npx shadcn@latest add button input textarea select card dialog skeleton toast

# æ•¸æ“šåº« ORM
npm install prisma @prisma/client

# èº«ä»½èªè­‰ Clerk
npm install @clerk/nextjs

# AI SDK
npm install openai

# åœ–ç‰‡å­˜å„² (AWS S3 å…¼å®¹ï¼Œç”¨æ–¼ Cloudflare R2)
npm install @aws-sdk/client-s3

# ç’°å¢ƒè®Šé‡æ ¡é©—
npm install @t3-oss/env-nextjs zod

# å¤šèªè¨€
npm install next-intl

# å·¥å…·åº«
npm install clsx tailwind-merge lucide-react

# åˆå§‹åŒ– Prisma
npx prisma init
```

### Step 0.4 â€” æ”¾å…¥ CLAUDE.md

```bash
# æŠŠä¹‹å‰ç”Ÿæˆçš„ CLAUDE.md æ”¾åˆ°é …ç›®æ ¹ç›®éŒ„
cp ~/Downloads/CLAUDE.md ./CLAUDE.md
```

### Step 0.5 â€” å•Ÿå‹• Claude Code

```bash
# åœ¨é …ç›®æ ¹ç›®éŒ„å•Ÿå‹•
claude

# Claude Code æœƒè‡ªå‹•è®€å– CLAUDE.md çš„è¦ç¯„
# ä½ ç¾åœ¨å¯ä»¥ç”¨è‡ªç„¶èªè¨€æŒ‡æ®å®ƒå¯«ä»£ç¢¼äº†
```

---

## ğŸ“¦ PHASE 1ï¼šMVP æ ¸å¿ƒè·‘é€šï¼ˆç¬¬ 2-4 å¤©ï¼‰

**ç›®æ¨™ï¼š** ç”¨æˆ¶èƒ½è¼¸å…¥ Promptï¼Œé¸æ“‡æ¨¡å‹ï¼Œçœ‹åˆ°ç”Ÿæˆçš„åœ–ç‰‡ï¼ˆæš«æ™‚ä¸å­˜æ•¸æ“šåº«ï¼‰

### Step 1.1 â€” è¨­ç½®ç’°å¢ƒè®Šé‡

å‰µå»º `.env.local`ï¼ˆå¾ä»¥ä¸‹æ¨¡æ¿è¤‡è£½ï¼‰ï¼š

```bash
# æ•¸æ“šåº«ï¼ˆPhase 2 å†é…ç½®ï¼Œå…ˆç•™ç©ºï¼‰
DATABASE_URL="postgresql://..."

# Clerk èªè­‰ï¼ˆPhase 3 å†é…ç½®ï¼Œå…ˆç•™ç©ºï¼‰
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=""
CLERK_SECRET_KEY=""

# AI Keysï¼ˆç¾åœ¨å°±è¦é…ç½®ï¼‰
OPENAI_API_KEY="sk-..."
SILICONFLOW_API_KEY="sk-..."   # ç”¨æ–¼ FLUX.1ï¼Œå» siliconflow.cn æ³¨å†Œ

# å­˜å„²ï¼ˆPhase 2 å†é…ç½®ï¼Œå…ˆç•™ç©ºï¼‰
R2_ACCOUNT_ID=""
R2_ACCESS_KEY_ID=""
R2_SECRET_ACCESS_KEY=""
R2_BUCKET_NAME=""
NEXT_PUBLIC_STORAGE_BASE_URL=""

# é€šç”¨
NEXT_PUBLIC_APP_URL="http://localhost:3000"
```

### Step 1.2 â€” å‰µå»ºç›®éŒ„çµæ§‹

```bash
# ä¸€éµå‰µå»ºæ‰€æœ‰ç›®éŒ„
mkdir -p src/constants src/types src/services/storage \
         src/hooks src/lib \
         src/components/ui src/components/business src/components/layout
```

### Step 1.3 â€” Claude Code ä»»å‹™æŒ‡ä»¤ï¼ˆæŒ‰é †åºåŸ·è¡Œï¼‰

æ‰“é–‹ Claude Codeï¼Œ**æŒ‰ä»¥ä¸‹é †åº**çµ¦å®ƒç™¼æŒ‡ä»¤ï¼š

---

**æŒ‡ä»¤ 1ï¼šå‰µå»ºå¸¸é‡æ–‡ä»¶**
```
è«‹æ ¹æ“š CLAUDE.md çš„è¦ç¯„ï¼Œå‰µå»ºä»¥ä¸‹æ–‡ä»¶ï¼š

1. src/constants/models.ts
   - å®šç¾© AI_MODELS æšèˆ‰ï¼ˆdall-e-3, flux-pro-1.1, stable-diffusion-3.5-largeï¼‰
   - å®šç¾© MODEL_OPTIONS æ•¸çµ„ï¼Œæ¯å€‹æ¨¡å‹åŒ…å«ï¼šid, label, cost(ç©åˆ†), provider, description
   - æ¨™è¨˜å“ªäº›æ¨¡å‹ç›®å‰å¯ç”¨ï¼ˆavailable: booleanï¼‰

2. src/constants/routes.ts
   - å®šç¾© ROUTES å°è±¡ï¼ŒåŒ…å«æ‰€æœ‰é é¢è·¯å¾‘

3. src/constants/config.ts
   - å®šç¾© DEFAULT_CREDITSï¼ˆæ–°ç”¨æˆ¶åˆå§‹ç©åˆ†ï¼š10ï¼‰
   - å®šç¾© IMAGE_SIZESï¼ˆæ”¯æŒçš„åœ–ç‰‡å°ºå¯¸é…ç½®ï¼‰
   - å®šç¾© API_ENDPOINTSï¼ˆæ‰€æœ‰ API è·¯å¾‘ï¼‰
```

---

**æŒ‡ä»¤ 2ï¼šå‰µå»ºé¡å‹å®šç¾©**
```
æ ¹æ“š CLAUDE.md è¦ç¯„å’Œ constants/models.tsï¼Œå‰µå»º src/types/index.tsï¼ŒåŒ…å«ï¼š
- GenerateRequest æ¥å£ï¼ˆprompt, modelId, aspectRatioï¼‰
- GenerateResponse æ¥å£ï¼ˆsuccess, data: { imageUrl, prompt, model }ï¼‰
- ImageRecord æ¥å£ï¼ˆå°æ‡‰æ•¸æ“šåº«çš„ Image è¡¨çµæ§‹ï¼‰
- ModelOption æ¥å£ï¼ˆå°æ‡‰ MODEL_OPTIONS çš„å…ƒç´ é¡å‹ï¼‰
ä½¿ç”¨ zod å®šç¾© GenerateRequestSchema ä¸¦æ¨å° GenerateRequest é¡å‹ã€‚
```

---

**æŒ‡ä»¤ 3ï¼šå‰µå»º API Client**
```
å‰µå»º src/lib/api-client.tsï¼Œå°è£ä»¥ä¸‹å‡½æ•¸ï¼š
- generateImageAPI(params: GenerateRequest): Promise<GenerateResponse>
  - èª¿ç”¨ POST /api/generate
  - åŒ…å«éŒ¯èª¤è™•ç†

å‰µå»º src/lib/utils.tsï¼ŒåŒ…å«ï¼š
- cn() å‡½æ•¸ï¼ˆåˆä½µ tailwind classï¼Œä½¿ç”¨ clsx + tailwind-mergeï¼‰
```

---

**æŒ‡ä»¤ 4ï¼šå‰µå»ºç”Ÿæˆåœ–ç‰‡çš„ API Route**
```
å‰µå»º src/app/api/generate/route.tsï¼ˆNext.js App Router æ ¼å¼ï¼‰ï¼š

åŠŸèƒ½ï¼š
1. ç”¨ zod æ ¡é©—è«‹æ±‚é«”ï¼ˆå¾ src/types å°å…¥ GenerateRequestSchemaï¼‰
2. æ ¹æ“š modelId é¸æ“‡å°æ‡‰çš„ AI æä¾›å•†ï¼š
   - dall-e-3 â†’ èª¿ç”¨ OpenAI API
   - flux-pro-1.1 â†’ èª¿ç”¨ SiliconFlow API
     endpoint: https://api.siliconflow.cn/v1/images/generations
3. è¿”å› GenerateResponse æ ¼å¼çš„éŸ¿æ‡‰
4. åŒ…å«å®Œæ•´çš„ try/catch éŒ¯èª¤è™•ç†

æ³¨æ„ï¼š
- å¾ src/constants/models.ts å°å…¥ AI_MODELSï¼Œä¸è¦ç¡¬ç·¨ç¢¼å­—ç¬¦ä¸²
- API Keys å¾ process.env è®€å–ï¼Œä¸è¦å¯«æ­»
- ç¾åœ¨æš«æ™‚ä¸å­˜æ•¸æ“šåº«ï¼Œåªè¿”å› AI çµ¦çš„åœ–ç‰‡ URL
```

---

**æŒ‡ä»¤ 5ï¼šå‰µå»º useGenerateImage Hook**
```
å‰µå»º src/hooks/use-generate.tsï¼š

åŠŸèƒ½ï¼š
- isGenerating: boolean ç‹€æ…‹
- error: string | null ç‹€æ…‹
- generatedImageUrl: string | null ç‹€æ…‹
- generate(params: GenerateRequest) å‡½æ•¸
  - èª¿ç”¨ api-client çš„ generateImageAPI
  - ç®¡ç† loading/error/success ç‹€æ…‹

å¾ src/types å°å…¥é¡å‹ï¼Œå¾ src/lib/api-client å°å…¥ API å‡½æ•¸ã€‚
```

---

**æŒ‡ä»¤ 6ï¼šå‰µå»º UI çµ„ä»¶**
```
å‰µå»º src/components/business/ModelSelector.tsxï¼š
- ä½¿ç”¨ shadcn/ui çš„ Select çµ„ä»¶
- å¾ src/constants/models.ts å°å…¥ MODEL_OPTIONS
- Props: { value: string, onChange: (value: string) => void }
- åªé¡¯ç¤º available: true çš„æ¨¡å‹

å‰µå»º src/components/business/GenerateForm.tsxï¼š
- ä½¿ç”¨ useGenerateImage hook
- åŒ…å«ï¼šModelSelector + Textareaï¼ˆè¼¸å…¥ promptï¼‰+ ç”ŸæˆæŒ‰éˆ•
- ç”Ÿæˆä¸­é¡¯ç¤º loading ç‹€æ…‹
- ç”Ÿæˆå®Œæˆå¾Œé¡¯ç¤ºåœ–ç‰‡ï¼ˆå¸¶æ¼¸å…¥å‹•ç•«ï¼‰
- é¡¯ç¤ºéŒ¯èª¤ä¿¡æ¯
```

---

**æŒ‡ä»¤ 7ï¼šå‰µå»ºé¦–é **
```
ä¿®æ”¹ src/app/[locale]/(main)/studio/page.tsxï¼ˆå…ˆå‰µå»ºé€™å€‹è·¯ç”±çµæ§‹ï¼‰ï¼š
- é é¢æ¨™é¡Œï¼šPersonal AI Gallery
- å±…ä¸­ä½ˆå±€ï¼Œæœ€å¤§å¯¬åº¦ 2xl
- åµŒå…¥ GenerateForm çµ„ä»¶

åŒæ™‚å‰µå»ºåŸºæœ¬çš„ src/app/layout.tsx å’Œ src/app/[locale]/layout.tsxã€‚

æš«æ™‚å…ˆåšè‹±æ–‡ç‰ˆï¼ˆlocale å…ˆå›ºå®šç”¨ enï¼‰ï¼Œå¤šèªè¨€ Phase 3 å†å®Œå–„ã€‚
```

---

### Step 1.4 â€” æ¸¬è©¦ Phase 1

```bash
npm run dev
# æ‰“é–‹ http://localhost:3000
# æ¸¬è©¦ï¼šè¼¸å…¥ promptï¼Œé¸æ¨¡å‹ï¼Œé»æ“Šç”Ÿæˆï¼Œæ‡‰è©²èƒ½çœ‹åˆ°åœ–ç‰‡
```

---

## ğŸ—„ï¸ PHASE 2ï¼šæŒä¹…åŒ–å­˜å„²ï¼ˆç¬¬ 5-7 å¤©ï¼‰

**ç›®æ¨™ï¼š** ç”Ÿæˆçš„åœ–ç‰‡æ°¸ä¹…ä¿å­˜åˆ° R2ï¼Œè¨˜éŒ„å­˜å…¥æ•¸æ“šåº«

### Step 2.1 â€” é…ç½®æ•¸æ“šåº«ï¼ˆNeon å…è²»ç‰ˆï¼‰

1. å» [neon.tech](https://neon.tech) æ³¨å†Šï¼Œå‰µå»ºæ•¸æ“šåº«
2. è¤‡è£½ Connection String åˆ° `.env.local` çš„ `DATABASE_URL`

### Step 2.2 â€” é…ç½® Prisma Schema

```bash
# ç”¨ Claude Code ç”Ÿæˆ schema
```

**Claude Code æŒ‡ä»¤ï¼š**
```
ä¿®æ”¹ prisma/schema.prismaï¼Œæ·»åŠ ä»¥ä¸‹ modelï¼š

User æ¨¡å‹ï¼š
- id: cuid
- clerkId: Stringï¼ˆå”¯ä¸€ï¼Œå°æ‡‰ Clerk çš„ç”¨æˆ¶ IDï¼‰
- email: Stringï¼ˆå”¯ä¸€ï¼‰
- credits: Intï¼ˆé»˜èª 10ï¼Œç©åˆ†ç³»çµ±ï¼‰
- createdAt, updatedAt
- images: Image[]ï¼ˆä¸€å°å¤šï¼‰

Image æ¨¡å‹ï¼š
- id: cuid
- createdAt: DateTime
- url: Stringï¼ˆR2 çš„æ°¸ä¹…éˆæ¥ï¼‰
- storageKey: Stringï¼ˆR2 bucket ä¸­çš„æ–‡ä»¶è·¯å¾‘ï¼‰
- prompt: String @db.Text
- negativePrompt: String? @db.Text
- model: String
- width: Intï¼ˆé»˜èª 1024ï¼‰
- height: Intï¼ˆé»˜èª 1024ï¼‰
- userId: String?ï¼ˆå¯é¸ï¼ŒéŠå®¢ä¹Ÿèƒ½ç”Ÿæˆä½†ä¸å­˜è³¬è™Ÿï¼‰
- user: User?ï¼ˆrelationï¼‰
- isPublic: Booleanï¼ˆé»˜èª trueï¼Œæ˜¯å¦é¡¯ç¤ºåœ¨å…¬å…±ç•«å»Šï¼‰

å‰µå»ºå®Œå¾Œå‘Šè¨´æˆ‘å¦‚ä½•åŸ·è¡Œ migrationã€‚
```

```bash
# åŸ·è¡Œæ•¸æ“šåº«é·ç§»
npx prisma migrate dev --name init

# ç”Ÿæˆ Prisma Client
npx prisma generate
```

### Step 2.3 â€” é…ç½® Cloudflare R2

1. å» [Cloudflare Dashboard](https://dash.cloudflare.com) â†’ R2
2. å‰µå»º Bucketï¼š`personal-ai-gallery`
3. å‰µå»º API Tokenï¼ˆéœ€è¦ Object Read & Write æ¬Šé™ï¼‰
4. é–‹å•Ÿ Bucket çš„ Public Access
5. æŠŠæ‰€æœ‰ R2 ç›¸é—œå€¼å¡«å…¥ `.env.local`

**Claude Code æŒ‡ä»¤ï¼š**
```
å‰µå»º src/services/storage/r2.tsï¼š
- ä½¿ç”¨ @aws-sdk/client-s3ï¼ˆR2 å…¼å®¹ S3 æ¥å£ï¼‰
- é…ç½® endpoint: `https://${R2_ACCOUNT_ID}.r2.cloudflarestorage.com`
- å¯¦ç¾ uploadImageFromUrl(url: string, key: string) å‡½æ•¸ï¼š
  1. å¾çµ¦å®š URL ä¸‹è¼‰åœ–ç‰‡ï¼ˆç”¨ fetchï¼‰
  2. ä¸Šå‚³åˆ° R2 bucket
  3. è¿”å›å…¬é–‹è¨ªå•çš„æ°¸ä¹… URLï¼ˆNEXT_PUBLIC_STORAGE_BASE_URL + keyï¼‰
- å¯¦ç¾ generateStorageKey() å‡½æ•¸ï¼šç”Ÿæˆå”¯ä¸€æ–‡ä»¶åï¼ˆæ—¥æœŸ+nanoidï¼‰
```

```
å‰µå»º src/lib/db.tsï¼š
- Prisma Client å–®ä¾‹ï¼ˆé˜²æ­¢é–‹ç™¼æ™‚ç†±é‡è¼‰å‰µå»ºå¤šå€‹é€£æ¥ï¼‰
- æ¨™æº– Next.js + Prisma çš„å–®ä¾‹å¯«æ³•
```

```
å‰µå»º src/services/image.service.tsï¼š
- å¯¦ç¾ createImage(params) å‡½æ•¸ï¼š
  1. èª¿ç”¨ AI API ç²å–è‡¨æ™‚åœ–ç‰‡ URL
  2. èª¿ç”¨ r2.uploadImageFromUrl() è½‰å­˜åˆ° R2
  3. èª¿ç”¨ prisma å¯«å…¥æ•¸æ“šåº«
  4. è¿”å› ImageRecord

ä¿®æ”¹ src/app/api/generate/route.tsï¼š
- æ”¹ç‚ºèª¿ç”¨ ImageService.createImage()
- è€Œä¸æ˜¯ç›´æ¥èª¿ç”¨ AI API
```

### Step 2.4 â€” å‰µå»ºåœ–ç‰‡åˆ—è¡¨ API

```
å‰µå»º src/app/api/images/route.tsï¼ˆGET è«‹æ±‚ï¼‰ï¼š
- æ”¯æŒåˆ†é ï¼ˆpage, limit æŸ¥è©¢åƒæ•¸ï¼Œé»˜èª limit=20ï¼‰
- åªè¿”å› isPublic: true çš„åœ–ç‰‡
- è¿”å›æ ¼å¼ï¼š{ data: ImageRecord[], total: number, hasMore: boolean }
```

---

## ğŸ‘¤ PHASE 3ï¼šç”¨æˆ¶ç³»çµ± + ç©åˆ†ï¼ˆç¬¬ 8-10 å¤©ï¼‰

**ç›®æ¨™ï¼š** ç™»éŒ„æ‰èƒ½ç”Ÿæˆï¼Œæ¯æ¬¡æ‰£ç©åˆ†

### Step 3.1 â€” é…ç½® Clerk

1. å» [clerk.com](https://clerk.com) æ³¨å†Šï¼Œå‰µå»º Application
2. é–‹å•Ÿ Google/GitHub ç™»éŒ„
3. æŠŠ Keys å¡«å…¥ `.env.local`

**Claude Code æŒ‡ä»¤ï¼š**
```
é…ç½® Clerk åˆ° Next.js é …ç›®ï¼š

1. ä¿®æ”¹ src/app/layout.tsxï¼Œç”¨ ClerkProvider åŒ…è£¹
2. å‰µå»º src/middleware.tsï¼Œä¿è­· /studio å’Œ /profile è·¯ç”±
   - å…¬é–‹è·¯ç”±ï¼š/, /gallery, /sign-in, /sign-up, /api/imagesï¼ˆGETï¼‰
   - ä¿è­·è·¯ç”±ï¼š/studio, /profile, /api/generateï¼ˆPOSTï¼‰

3. å‰µå»º src/app/[locale]/(auth)/sign-in/page.tsx
   ä½¿ç”¨ Clerk çš„ <SignIn /> çµ„ä»¶

4. å‰µå»º src/app/[locale]/(auth)/sign-up/page.tsx
   ä½¿ç”¨ Clerk çš„ <SignUp /> çµ„ä»¶

5. å‰µå»º src/app/api/webhooks/clerk/route.ts
   ç›£è½ user.created äº‹ä»¶ï¼Œåœ¨æ•¸æ“šåº«å‰µå»ºå°æ‡‰ User è¨˜éŒ„ï¼ˆåˆå§‹ 10 ç©åˆ†ï¼‰
```

### Step 3.2 â€” ç©åˆ†ç³»çµ±

```
ä¿®æ”¹ src/services/user.service.tsï¼Œæ·»åŠ ï¼š
- getUserCredits(clerkId: string): Promise<number>
- deductCredits(clerkId: string, amount: number): Promise<void>
  - å¦‚æœç©åˆ†ä¸è¶³ï¼Œæ‹‹å‡ºè‡ªå®šç¾©éŒ¯èª¤ InsufficientCreditsError
- addCredits(clerkId: string, amount: number): Promise<void>

ä¿®æ”¹ src/app/api/generate/route.tsï¼Œæ·»åŠ ï¼š
1. ç”¨ auth() from @clerk/nextjs/server ç²å–ç•¶å‰ç”¨æˆ¶
2. æŸ¥è©¢è©² model çš„ costï¼ˆå¾ MODEL_OPTIONS ä¸­å–ï¼‰
3. èª¿ç”¨ UserService.deductCredits()
4. å¦‚æœç©åˆ†ä¸è¶³ï¼Œè¿”å› 402 ç‹€æ…‹ç¢¼

å‰µå»º src/hooks/use-credits.tsï¼š
- ç²å–ç•¶å‰ç”¨æˆ¶ç©åˆ†çš„ hook
- åœ¨ Studio é é¢é ‚éƒ¨é¡¯ç¤ºå‰©é¤˜ç©åˆ†
```

---

## ğŸ¨ PHASE 4ï¼šUI å„ªåŒ– + ç•«å»Šé ï¼ˆç¬¬ 11-14 å¤©ï¼‰

### Step 4.1 â€” ç•«å»Šé 

```
å‰µå»º src/hooks/use-gallery.tsï¼š
- èª¿ç”¨ GET /api/images
- æ”¯æŒç„¡é™æ»¾å‹•ï¼ˆIntersectionObserverï¼‰
- è¿”å›ï¼šimages, isLoading, hasMore, loadMore

å‰µå»º src/components/business/ImageCard.tsxï¼š
- é¡¯ç¤ºåœ–ç‰‡ç¸®ç•¥åœ–
- hover æ•ˆæœï¼šé¡¯ç¤º prompt é è¦½å’Œä¸‹è¼‰æŒ‰éˆ•
- é»æ“Šæ‰“é–‹ Modal é¡¯ç¤ºå¤§åœ–è©³æƒ…

å‰µå»º src/components/business/GalleryGrid.tsxï¼š
- CSS Masonry ç€‘å¸ƒæµä½ˆå±€ï¼ˆä½¿ç”¨ CSS columns å¯¦ç¾ï¼‰
- éŸ¿æ‡‰å¼ï¼š4åˆ—ï¼ˆæ¡Œé¢ï¼‰â†’ 3åˆ—ï¼ˆå¹³æ¿ï¼‰â†’ 2åˆ—ï¼ˆæ‰‹æ©Ÿï¼‰
- æ•´åˆ use-gallery hook

å‰µå»º src/app/[locale]/(main)/gallery/page.tsx
```

### Step 4.2 â€” å°èˆªæ¬„

```
å‰µå»º src/components/layout/Navbar.tsxï¼š
- å·¦å´ï¼šLogoï¼ˆéˆæ¥åˆ°é¦–é ï¼‰
- å³å´ï¼šç”¨æˆ¶ç™»éŒ„ç‹€æ…‹ï¼ˆClerk çš„ <UserButton />ï¼‰+ ç©åˆ†é¡¯ç¤º
- éŸ¿æ‡‰å¼ï¼šæ‰‹æ©Ÿç«¯éš±è—æ–‡å­—ï¼Œåªé¡¯ç¤ºåœ–æ¨™

å‰µå»º src/components/layout/MobileTabBar.tsxï¼š
- æ‰‹æ©Ÿç«¯åº•éƒ¨ Tab Barï¼ˆåƒ…åœ¨ç§»å‹•ç«¯é¡¯ç¤ºï¼‰
- 4å€‹ Tabï¼šGalleryã€Studioã€Profileã€Credits
- ä½¿ç”¨ ROUTES å¸¸é‡ï¼Œä¸ç¡¬ç·¨ç¢¼è·¯å¾‘
```

---

## ğŸ“± PHASE 5ï¼šç§»å‹•ç«¯æ‰“åŒ…ï¼ˆç¬¬ 15-16 å¤©ï¼‰

### Step 5.1 â€” é…ç½® Capacitor

```bash
npm install @capacitor/core @capacitor/cli
npm install @capacitor/ios @capacitor/android
npm install @capacitor/haptics @capacitor/share

# åˆå§‹åŒ– Capacitor
npx cap init "Personal AI Gallery" "com.yourname.aigallery"

# æ§‹å»º Next.jsï¼ˆéœæ…‹è¼¸å‡ºï¼‰
npm run build

# æ·»åŠ å¹³å°
npx cap add ios
npx cap add android
```

**ä¿®æ”¹ `next.config.ts`ï¼š**
```js
// æ·»åŠ éœæ…‹è¼¸å‡ºæ”¯æŒ
output: 'export',
images: { unoptimized: true }
```

### Step 5.2 â€” ç§»å‹•ç«¯ç‰¹æ€§

**Claude Code æŒ‡ä»¤ï¼š**
```
å‰µå»º src/hooks/use-haptics.tsï¼š
- å°è£ @capacitor/haptics
- æä¾› triggerSuccess() å’Œ triggerError() å‡½æ•¸
- åœ¨éç§»å‹•ç«¯å„ªé›…é™ç´šï¼ˆno-opï¼‰

ä¿®æ”¹ src/components/business/GenerateForm.tsxï¼š
- ç”ŸæˆæˆåŠŸå¾Œèª¿ç”¨ triggerSuccess()
- ç”Ÿæˆå¤±æ•—å¾Œèª¿ç”¨ triggerError()

ä¿®æ”¹ src/components/business/ImageCard.tsxï¼š
- åœ¨ç§»å‹•ç«¯é•·æŒ‰åœ–ç‰‡æ™‚ï¼Œä½¿ç”¨ @capacitor/share èª¿ç”¨ç³»çµ±åˆ†äº«/ä¿å­˜
```

```bash
# åŒæ­¥ä»£ç¢¼åˆ° native é …ç›®
npx cap sync

# æ‰“é–‹ Xcodeï¼ˆiOSï¼‰
npx cap open ios

# æ‰“é–‹ Android Studio
npx cap open android
```

---

## ğŸŒ PHASE 6ï¼šå¤šèªè¨€ï¼ˆé¸åšï¼‰

```
ä½¿ç”¨ next-intl é…ç½®ä¸‰èªè¨€æ”¯æŒï¼ˆzh/en/jaï¼‰ï¼š
1. å‰µå»º messages/zh.jsonã€messages/en.jsonã€messages/ja.json
2. é…ç½® src/i18n.ts å’Œ src/middleware.tsï¼ˆåˆä½µ Clerk å’Œ i18n çš„ middlewareï¼‰
3. ä¿®æ”¹æ‰€æœ‰é é¢ä½¿ç”¨ useTranslations() æ›¿æ›ç¡¬ç·¨ç¢¼æ–‡å­—
4. åœ¨ Navbar æ·»åŠ èªè¨€åˆ‡æ›å™¨
```

---

## ğŸ”§ å¸¸ç”¨ Claude Code å°è©±æŠ€å·§

### é–‹å§‹ä¸€å€‹åŠŸèƒ½å‰ï¼š
```
æˆ‘è¦é–‹å§‹é–‹ç™¼ [åŠŸèƒ½å]ï¼Œè«‹å…ˆï¼š
1. è®€å– CLAUDE.md ç¢ºèªè¦ç¯„
2. æŸ¥çœ‹ src/constants/ æœ‰å“ªäº›å·²å®šç¾©çš„å¸¸é‡
3. å‘Šè¨´æˆ‘ä½ æ‰“ç®—å‰µå»ºå“ªäº›æ–‡ä»¶ï¼Œæˆ‘ç¢ºèªå¾Œå†é–‹å§‹å¯«ä»£ç¢¼
```

### ä»£ç¢¼ Review æ™‚ï¼š
```
è«‹ Review å‰›æ‰å¯«çš„ä»£ç¢¼ï¼Œæª¢æŸ¥ï¼š
1. æœ‰æ²’æœ‰é•å CLAUDE.md çš„è¦ç¯„ï¼Ÿ
2. æœ‰æ²’æœ‰ Magic Valuesï¼Ÿ
3. æœ‰æ²’æœ‰ç”¨åˆ° any é¡å‹ï¼Ÿ
4. é‚è¼¯æœ‰æ²’æœ‰æ”¾éŒ¯å±¤ï¼ˆæ¯”å¦‚æ¥­å‹™é‚è¼¯å¯«åœ¨çµ„ä»¶è£¡ï¼‰ï¼Ÿ
```

### é‡åˆ° Bug æ™‚ï¼š
```
æˆ‘é‡åˆ°äº†ä»¥ä¸‹éŒ¯èª¤ï¼š
[ç²˜è²¼éŒ¯èª¤ä¿¡æ¯]

ç›¸é—œæ–‡ä»¶ï¼š[æ–‡ä»¶è·¯å¾‘]
è«‹å¹«æˆ‘è¨ºæ–·åŸå› ï¼Œä¸¦æå‡ºä¿®å¾©æ–¹æ¡ˆï¼Œä¿®å¾©å‰å…ˆå‘Šè¨´æˆ‘ä½ çš„æ€è·¯ã€‚
```

---

## âœ… æ¯å€‹ Phase å®Œæˆçš„é©—æ”¶æ¨™æº–

| Phase | é©—æ”¶æ¨™æº– |
|-------|---------|
| Phase 1 | è¼¸å…¥ Prompt èƒ½ç”Ÿæˆåœ–ç‰‡ï¼Œé¡¯ç¤ºåœ¨é é¢ä¸Š |
| Phase 2 | åœ–ç‰‡å­˜å…¥ R2ï¼Œæ•¸æ“šåº«æœ‰è¨˜éŒ„ï¼ŒF5 åˆ·æ–°ä¸æ¶ˆå¤± |
| Phase 3 | æœªç™»éŒ„ç„¡æ³•è¨ªå• /studioï¼Œç™»éŒ„å¾Œæ¯æ¬¡ç”Ÿæˆæ‰£ç©åˆ† |
| Phase 4 | ç•«å»Šç€‘å¸ƒæµå±•ç¤ºï¼Œé»æ“Šåœ–ç‰‡æœ‰è©³æƒ…å½ˆçª— |
| Phase 5 | æ‰“åŒ…æˆ App å¯åœ¨æ‰‹æ©Ÿé‹è¡Œï¼Œç”ŸæˆæˆåŠŸæœ‰éœ‡å‹• |
